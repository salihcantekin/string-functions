@page "/trim-pad"

<PageTitle>Trim/Pad</PageTitle>

<FluentStack Orientation="Orientation.Vertical" Style="gap: 20px;">
    <FluentCard Style="padding: 20px;">
        <FluentLabel Typo="Typography.H3">Trim/Pad</FluentLabel>
        <FluentLabel Typo="Typography.Body">String başı/sonu boşluk işlemleri ve padding ekleyin.</FluentLabel>
    </FluentCard>

    <FluentCard Style="padding: 20px;">
        <FluentStack Orientation="Orientation.Vertical" Style="gap: 16px;">
            <FluentLabel Typo="Typography.H5">Ayarlar</FluentLabel>
            
            <FluentSelect TOption="string" @bind-Value="@operationMode" Label="İşlem" Style="width: 100%;">
                <FluentOption Value="trim">Trim (Başı ve sonu temizle)</FluentOption>
                <FluentOption Value="trimstart">Trim Start (Sadece başı temizle)</FluentOption>
                <FluentOption Value="trimend">Trim End (Sadece sonu temizle)</FluentOption>
                <FluentOption Value="padleft">Pad Left (Sola padding ekle)</FluentOption>
                <FluentOption Value="padright">Pad Right (Sağa padding ekle)</FluentOption>
            </FluentSelect>
            
            @if (operationMode.StartsWith("pad"))
            {
                <FluentNumberField @bind-Value="@totalWidth" Label="Toplam genişlik" Min="1" Style="width: 100%;" />
                <FluentTextField @bind-Value="@paddingChar" Label="Padding karakteri" Placeholder=" " Style="width: 100%;" MaxLength="1" />
            }
            
            @if (operationMode.StartsWith("trim"))
            {
                <FluentTextField @bind-Value="@trimChars" Label="Temizlenecek karakterler (boş = boşluk)" Placeholder=" " Style="width: 100%;" />
            }
            
            <FluentCheckbox @bind-Value="@applyToEachLine" Label="Her satıra ayrı ayrı uygula" />
        </FluentStack>
    </FluentCard>

    <FluentCard Style="padding: 20px;">
        <FluentStack Orientation="Orientation.Vertical" Style="gap: 12px;">
            <FluentLabel Typo="Typography.H5">Giriş</FluentLabel>
            <FluentTextArea @bind-Value="@inputText" 
                           Placeholder="İşlenecek metni girin..."
                           Rows="10"
                           Style="width: 100%;"
                           @oninput="OnInputChanged" />
        </FluentStack>
    </FluentCard>

    <FluentCard Style="padding: 20px;">
        <FluentStack Orientation="Orientation.Vertical" Style="gap: 12px;">
            <FluentStack Orientation="Orientation.Horizontal" Style="justify-content: space-between; align-items: center;">
                <FluentLabel Typo="Typography.H5">Çıktı</FluentLabel>
                <FluentButton Appearance="Appearance.Accent" OnClick="CopyToClipboard" Disabled="@string.IsNullOrEmpty(outputText)">
                    Kopyala
                </FluentButton>
            </FluentStack>
            <FluentTextArea Value="@outputText" 
                           ReadOnly="true"
                           Rows="10"
                           Style="width: 100%;" />
        </FluentStack>
    </FluentCard>
</FluentStack>

@code {
    [Inject] private IJSRuntime JSRuntime { get; set; } = default!;
    
    private string inputText = string.Empty;
    private string outputText = string.Empty;
    private string operationMode = "trim";
    private int totalWidth = 20;
    private string paddingChar = " ";
    private string trimChars = string.Empty;
    private bool applyToEachLine = false;

    private void OnInputChanged(ChangeEventArgs e)
    {
        inputText = e.Value?.ToString() ?? string.Empty;
        Process();
    }


    private void Process()
    {
        if (string.IsNullOrEmpty(inputText))
        {
            outputText = string.Empty;
            return;
        }

        if (applyToEachLine)
        {
            var lines = inputText.Split('\n');
            outputText = string.Join("\n", lines.Select(ProcessLine));
        }
        else
        {
            outputText = ProcessLine(inputText);
        }
    }

    private string ProcessLine(string line)
    {
        var chars = string.IsNullOrEmpty(trimChars) ? null : trimChars.ToCharArray();
        var padChar = string.IsNullOrEmpty(paddingChar) ? ' ' : paddingChar[0];

        return operationMode switch
        {
            "trim" => chars == null ? line.Trim() : line.Trim(chars),
            "trimstart" => chars == null ? line.TrimStart() : line.TrimStart(chars),
            "trimend" => chars == null ? line.TrimEnd() : line.TrimEnd(chars),
            "padleft" => line.PadLeft(totalWidth, padChar),
            "padright" => line.PadRight(totalWidth, padChar),
            _ => line
        };
    }

    private async Task CopyToClipboard()
    {
        await JSRuntime.InvokeVoidAsync("navigator.clipboard.writeText", outputText);
    }
}
