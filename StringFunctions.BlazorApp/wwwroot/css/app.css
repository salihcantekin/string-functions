/* Theme Variables */
/* Light Theme - Default theme applied to :root and explicit light-theme class */
:root,
:root.light-theme,
html.light-theme,
.light-theme {
    --bg-primary: #ffffff;
    --bg-secondary: #f8f9fa;
    --bg-tertiary: #f0f0f0;
    --bg-card: #ffffff;
    --bg-header: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    
    --text-primary: #323130;
    --text-secondary: #605e5c;
    --text-tertiary: #8a8886;
    --text-inverse: #ffffff;
    
    --border-color: #e9ecef;
    --border-color-strong: #d2d0ce;
    
    --accent-primary: #0078d4;
    --accent-hover: #106ebe;
    --accent-light: #e7f1ff;
    
    --success: #107c10;
    --success-bg: #dff6dd;
    --warning: #ffb900;
    --warning-bg: #fff4ce;
    --error: #d13438;
    --error-bg: #fde7e9;
    
    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
    --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
    
    --input-bg: #ffffff;
    --input-border: #8a8886;
    --input-focus-border: #0078d4;
    --input-text: #323130;
    
    --code-bg: #f4f4f4;
    
    /* FluentUI Light Theme Variables */
    --neutral-fill-rest: #ffffff;
    --neutral-fill-hover: #f3f2f1;
    --neutral-fill-active: #edebe9;
    --neutral-fill-input-rest: #ffffff;
    --neutral-fill-input-hover: #f3f2f1;
    --neutral-fill-input-active: #ffffff;
    --neutral-stroke-rest: #8a8886;
    --neutral-stroke-hover: #323130;
    --neutral-foreground-rest: #323130;
    --neutral-foreground-hover: #201f1e;
    --neutral-layer-1: #ffffff;
    --neutral-layer-2: #f8f9fa;
    --accent-fill-rest: #0078d4;
    --accent-fill-hover: #106ebe;
    --accent-fill-active: #005a9e;
    --accent-foreground-rest: #ffffff;
}

/* Dark Theme - Override light theme when dark-theme class is present */
:root.dark-theme,
html.dark-theme,
.dark-theme {
    --bg-primary: #1f1f1f;
    --bg-secondary: #2d2d2d;
    --bg-tertiary: #3d3d3d;
    --bg-card: #2d2d2d;
    --bg-header: linear-gradient(135deg, #4a5568 0%, #553c9a 100%);
    
    --text-primary: #e1e1e1;
    --text-secondary: #b3b3b3;
    --text-tertiary: #8c8c8c;
    --text-inverse: #ffffff;
    
    --border-color: #404040;
    --border-color-strong: #555555;
    
    --accent-primary: #4da6ff;
    --accent-hover: #6bb8ff;
    --accent-light: #1a3a5c;
    
    --success: #4caf50;
    --success-bg: #1e3a1e;
    --warning: #ff9800;
    --warning-bg: #3d2e00;
    --error: #f44336;
    --error-bg: #3d1a1a;
    
    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);
    --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.4);
    --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.5);
    
    --input-bg: #3d3d3d;
    --input-border: #555555;
    --input-focus-border: #4da6ff;
    --input-text: #e1e1e1;
    
    --code-bg: #2d2d2d;
    
    /* FluentUI Dark Theme Variables */
    --neutral-fill-rest: #2d2d2d;
    --neutral-fill-hover: #3d3d3d;
    --neutral-fill-active: #4d4d4d;
    --neutral-fill-input-rest: #3d3d3d;
    --neutral-fill-input-hover: #4d4d4d;
    --neutral-fill-input-active: #3d3d3d;
    --neutral-stroke-rest: #555555;
    --neutral-stroke-hover: #b3b3b3;
    --neutral-foreground-rest: #e1e1e1;
    --neutral-foreground-hover: #ffffff;
    --neutral-layer-1: #1f1f1f;
    --neutral-layer-2: #2d2d2d;
    --accent-fill-rest: #4da6ff;
    --accent-fill-hover: #6bb8ff;
    --accent-fill-active: #3d8ee6;
    --accent-foreground-rest: #000000;
}

/* Base Styles */
html, body {
    font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif;
    margin: 0;
    padding: 0;
    background-color: var(--bg-primary);
    color: var(--text-primary);
    transition: background-color 0.2s ease, color 0.2s ease;
}

/* Z-Index Layers */
:root {
    --z-dropdown: 1000;
    --z-sticky: 1020;
    --z-fixed: 1030;
    --z-modal-backdrop: 1040;
    --z-modal: 1050;
    --z-popover: 1060;
    --z-tooltip: 1070;
}

/* Fix dropdown/select z-index issues */
fluent-select,
fluent-combobox,
fluent-menu,
.fluent-select-listbox,
.fluent-combobox-listbox {
    z-index: var(--z-dropdown) !important;
}

fluent-select::part(listbox),
fluent-combobox::part(listbox) {
    z-index: var(--z-dropdown) !important;
    background: var(--bg-card);
    border: 1px solid var(--border-color);
    box-shadow: var(--shadow-md);
}

/* Card base styles - ensure proper stacking */
.fluent-card,
fluent-card {
    position: relative;
    z-index: 1;
    overflow: visible !important;
}

/* Options toolbar should not clip dropdowns */
.options-toolbar {
    position: relative;
    z-index: 10;
    overflow: visible !important;
}

.options-toolbar fluent-select,
.options-toolbar fluent-combobox {
    z-index: var(--z-dropdown);
}

/* Blazor Error UI */
#blazor-error-ui {
    background: var(--warning-bg);
    color: var(--text-primary);
    bottom: 0;
    box-shadow: var(--shadow-lg);
    display: none;
    left: 0;
    padding: 0.6rem 1.25rem 0.7rem 1.25rem;
    position: fixed;
    width: 100%;
    z-index: var(--z-fixed);
}

#blazor-error-ui .dismiss {
    cursor: pointer;
    position: absolute;
    right: 0.75rem;
    top: 0.5rem;
}

.blazor-error-boundary {
    background: var(--error);
    padding: 1rem 1rem 1rem 3.7rem;
    color: white;
}

.blazor-error-boundary::after {
    content: "An error has occurred."
}

/* Scrollbar Styling */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: var(--bg-secondary);
}

::-webkit-scrollbar-thumb {
    background: var(--text-tertiary);
    border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--text-secondary);
}

/* Focus styles */
*:focus-visible {
    outline: 2px solid var(--accent-primary);
    outline-offset: 2px;
}

/* Button base enhancements */
fluent-button[appearance="accent"] {
    --accent-fill-rest: var(--accent-primary) !important;
    --accent-fill-hover: var(--accent-hover) !important;
}

/* ==================================================
   CENTRALIZED FLUENTUI COMPONENT THEME STYLES
   All FluentUI components will inherit from these
   
   NOTE: !important is required here because FluentUI
   components use Shadow DOM, which isolates their styles.
   CSS variables can penetrate Shadow DOM boundaries, but
   we need !important to ensure theme changes override
   the component's internal default styles.
   ================================================== */

/* Checkbox - Theme variables set on component for Shadow DOM */
fluent-checkbox {
    --neutral-fill-input-rest: var(--input-bg) !important;
    --neutral-stroke-rest: var(--input-border) !important;
    --neutral-foreground-rest: var(--text-primary) !important;
    --accent-fill-rest: var(--accent-primary) !important;
    --accent-fill-hover: var(--accent-hover) !important;
}

fluent-checkbox::part(control) {
    background: var(--input-bg) !important;
    border-color: var(--input-border) !important;
}

fluent-checkbox::part(label) {
    color: var(--text-primary) !important;
}

/* Select / Dropdown - Theme variables set on component for Shadow DOM */
fluent-select,
fluent-combobox {
    --neutral-fill-input-rest: var(--input-bg) !important;
    --neutral-fill-input-hover: var(--input-bg) !important;
    --neutral-stroke-rest: var(--input-border) !important;
    --neutral-stroke-hover: var(--input-focus-border) !important;
    --neutral-foreground-rest: var(--text-primary) !important;
}

fluent-select::part(control),
fluent-combobox::part(control) {
    background: var(--input-bg) !important;
    border-color: var(--input-border) !important;
    color: var(--text-primary) !important;
}

fluent-select::part(listbox),
fluent-combobox::part(listbox) {
    background: var(--bg-card) !important;
    border: 1px solid var(--border-color) !important;
    color: var(--text-primary) !important;
}

fluent-option {
    --neutral-fill-rest: var(--bg-card) !important;
    --neutral-fill-hover: var(--bg-tertiary) !important;
    --neutral-foreground-rest: var(--text-primary) !important;
    background: var(--bg-card) !important;
    color: var(--text-primary) !important;
}

fluent-option:hover {
    background: var(--bg-tertiary) !important;
}

/* Button - All appearances - Theme variables set on component for Shadow DOM */
fluent-button {
    --neutral-fill-rest: var(--bg-secondary) !important;
    --neutral-fill-hover: var(--bg-tertiary) !important;
    --neutral-foreground-rest: var(--text-primary) !important;
    --neutral-stroke-rest: var(--border-color) !important;
}

fluent-button::part(control) {
    color: var(--text-primary) !important;
    background: var(--bg-secondary) !important;
    border-color: var(--border-color) !important;
}

fluent-button[appearance="accent"]::part(control) {
    background: var(--accent-primary) !important;
    color: var(--text-inverse) !important;
}

fluent-button[appearance="accent"]:hover::part(control) {
    background: var(--accent-hover) !important;
}

fluent-button[appearance="outline"]::part(control) {
    background: transparent !important;
    border-color: var(--border-color-strong) !important;
    color: var(--text-primary) !important;
}

fluent-button[appearance="stealth"]::part(control) {
    background: transparent !important;
    border: none !important;
    color: var(--text-primary) !important;
}

fluent-button[appearance="stealth"]:hover::part(control) {
    background: var(--bg-tertiary) !important;
    color: var(--text-primary) !important;
}

/* TextArea and TextField theme support */
fluent-text-area,
fluent-text-field,
fluent-number-field {
    --neutral-fill-input-rest: var(--input-bg) !important;
    --neutral-stroke-rest: var(--input-border) !important;
    --neutral-foreground-rest: var(--text-primary) !important;
    --neutral-fill-input-hover: var(--input-bg) !important;
    --neutral-stroke-hover: var(--input-focus-border) !important;
}

fluent-text-area::part(control),
fluent-text-field::part(control),
fluent-number-field::part(control) {
    background: var(--input-bg) !important;
    color: var(--text-primary) !important;
    border-color: var(--input-border) !important;
}

fluent-text-area::part(control)::placeholder,
fluent-text-field::part(control)::placeholder {
    color: var(--text-tertiary) !important;
}

/* Label */
fluent-label {
    color: var(--text-primary) !important;
}

/* Card theme support */
fluent-card {
    --card-background-color: var(--bg-card) !important;
    --neutral-fill-rest: var(--bg-card) !important;
    background: var(--bg-card) !important;
    border: 1px solid var(--border-color) !important;
    color: var(--text-primary) !important;
}

/* Message bar theme support */
fluent-message-bar[intent="info"] {
    background: var(--accent-light) !important;
    border-color: var(--accent-primary) !important;
    color: var(--text-primary) !important;
}

fluent-message-bar[intent="success"] {
    background: var(--success-bg) !important;
    border-color: var(--success) !important;
    color: var(--text-primary) !important;
}

fluent-message-bar[intent="warning"] {
    background: var(--warning-bg) !important;
    border-color: var(--warning) !important;
    color: var(--text-primary) !important;
}

fluent-message-bar[intent="error"] {
    background: var(--error-bg) !important;
    border-color: var(--error) !important;
    color: var(--text-primary) !important;
}

/* ============================================
   TEXTAREA HEIGHT FIXES
   FluentTextArea needs special handling for height
   ============================================ */

/* Base textarea sizing - ensures textarea fills container */
fluent-text-area {
    display: flex;
    flex-direction: column;
    width: 100%;
}

fluent-text-area::part(control) {
    resize: vertical;
    font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
    font-size: 0.9rem;
    line-height: 1.5;
}

/* Standard height textarea (for most tools) */
.textarea-standard fluent-text-area,
fluent-text-area.textarea-standard {
    min-height: 400px;
    height: 400px;
}

.textarea-standard fluent-text-area::part(control),
fluent-text-area.textarea-standard::part(control) {
    min-height: 380px;
    height: 100%;
}

/* Large height textarea (for JSON tools) */
.textarea-large fluent-text-area,
fluent-text-area.textarea-large {
    min-height: 500px;
    height: 500px;
}

.textarea-large fluent-text-area::part(control),
fluent-text-area.textarea-large::part(control) {
    min-height: 480px;
    height: 100%;
}

/* Extra large textarea */
.textarea-xlarge fluent-text-area,
fluent-text-area.textarea-xlarge {
    min-height: 600px;
    height: 600px;
}

.textarea-xlarge fluent-text-area::part(control),
fluent-text-area.textarea-xlarge::part(control) {
    min-height: 580px;
    height: 100%;
}

/* io-panel textarea - fills available space */
.io-panel fluent-text-area {
    flex: 1;
    min-height: 400px;
}

.io-panel fluent-text-area::part(control) {
    min-height: 380px;
    height: 100%;
}

/* JSON tool panels need larger textareas */
.json-tool-grid fluent-text-area,
.json-input-area fluent-text-area {
    flex: 1;
    min-height: 500px;
}

.json-tool-grid fluent-text-area::part(control),
.json-input-area fluent-text-area::part(control) {
    min-height: 480px;
    height: 100%;
}

/* Output panels */
.output-panel fluent-text-area {
    flex: 1;
    min-height: 500px;
}

.output-panel fluent-text-area::part(control) {
    min-height: 480px;
    height: 100%;
}

/* Compare grids */
.compare-grid fluent-text-area {
    flex: 1;
    min-height: 450px;
}

.compare-grid fluent-text-area::part(control) {
    min-height: 430px;
    height: 100%;
}

/* Mobile responsive textarea heights */
@media (max-width: 768px) {
    .io-panel fluent-text-area,
    .json-tool-grid fluent-text-area,
    .json-input-area fluent-text-area,
    .output-panel fluent-text-area,
    .compare-grid fluent-text-area {
        min-height: 250px;
    }

    .io-panel fluent-text-area::part(control),
    .json-tool-grid fluent-text-area::part(control),
    .json-input-area fluent-text-area::part(control),
    .output-panel fluent-text-area::part(control),
    .compare-grid fluent-text-area::part(control) {
        min-height: 230px;
    }

    .textarea-standard fluent-text-area,
    fluent-text-area.textarea-standard {
        min-height: 250px;
        height: 250px;
    }

    .textarea-large fluent-text-area,
    fluent-text-area.textarea-large,
    .textarea-xlarge fluent-text-area,
    fluent-text-area.textarea-xlarge {
        min-height: 280px;
        height: 280px;
    }
}
